///////////////////////////////////////////////////////////////////////////////////////
//                     gesedels · a key-value API in Go · v0.0.0                     //
///////////////////////////////////////////////////////////////////////////////////////

package main

import (
	"fmt"
	"net/http"
)

///////////////////////////////////////////////////////////////////////////////////////
//                          part one · constants and globals                         //
///////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////////
//                      part two · string sanitisation functions                     //
///////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////////
//                      part three · database handling functions                     //
///////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////////
//                        part four · http response functions                        //
///////////////////////////////////////////////////////////////////////////////////////

// WriteHTTP writes a plaintext response to a ResponseWriter.
func WriteHTTP(w http.ResponseWriter, code int, form string, elems ...any) {
	w.Header().Set("Content-Type", "text/plain; charset=utf-8")
	w.WriteHeader(code)
	fmt.Fprintf(w, form+"\n", elems...)
}

// WriteError writes a plaintext error response to a ResponseWriter.
func WriteError(w http.ResponseWriter, code int, form string, elems ...any) {
	form = fmt.Sprintf("server error %d: %s", code, form)
	WriteHTTP(w, code, form, elems...)
}

// WriteFailure writes a plaintext failure response to a ResponseWriter.
func WriteFailure(w http.ResponseWriter, code int, form string, elems ...any) {
	form = fmt.Sprintf("client error %d: %s", code, form)
	WriteHTTP(w, code, form, elems...)
}

///////////////////////////////////////////////////////////////////////////////////////
//                        part five · server type and methods                        //
///////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////////
//                         part six · server endpoint methods                        //
///////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////////
//                        part seven · main runtime functions                        //
///////////////////////////////////////////////////////////////////////////////////////
